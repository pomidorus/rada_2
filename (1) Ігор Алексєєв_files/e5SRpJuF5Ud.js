/*!CK:98414484!*//*1436769893,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["RtENj"]); }

__d("CalendarUI",["Event","Arbiter","AsyncRequest","CSS","DOM","DOMQuery","DOMScroll","Hovercard","Parent","Run","ScrollAwareDOM","Style","UIPagelet","Vector","ViewportBounds","$","ge","goURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();function y(){}Object.assign(y,{EVENT_ACTION:'EVENT_ACTION',_todayButton:null,_todayElement:null,_upPager:null,_months:[],_timestamp:null,_registeredReminders:false,init:function(){h.subscribe(this.EVENT_ACTION,function(aa,ba){s.loadFromEndpoint('CalendarHeaderPagelet','pagelet_calendar_header',JSON.parse(ba.actioncontext));});var z=u.addTop(function(){var aa=w('pagelet_calendar_header');if(aa&&r.isFixed(aa.firstChild)){var ba=aa.firstChild.getBoundingClientRect();return ba.bottom;}return 0;});p.onLeave(function(){z.remove();});},initGridItem:function(z,aa){g.listen(z,'click',function(event){if(o.byTag(event.getTarget(),'a'))return;i.bootstrap(aa,z);return;});},pageUp:function(){j.removeClass(this._upPager.parentNode,'fbCalendarNoPadding');j.addClass(this._upPager.parentNode,'pvl');if(this._upPager)this._upPager.click();},getScrollFunction:function(z){var aa=this;return function(event){var ba=o.byClass(event.getTarget(),'fbCalendarBox'),ca=aa._months.indexOf(ba);if(z&&ca===0){aa.pageUp();}else aa.scrollTo(aa._months[ca+(z?-1:1)],true);};},registerArrowHandlers:function(z,aa){g.listen(z,'click',this.getScrollFunction(true));g.listen(aa,'click',this.getScrollFunction(false));},initScrollItem:function(z,aa){g.listen(z,'click',this.scrollTo.bind(this,aa));},scrollTo:function(z,aa){z=l.isNode(z)?z:w(z);var ba=0,ca=40;if(z){var da=t.getElementPosition(v('fbCalendarWrapper')).y,ea;if(document.getElementById('headerArea')){ea=t.getElementDimensions(v('headerArea')).y;}else{ea=0;ca=12;}var fa=t.getElementPosition(z).y;ba=fa-da-ea+ca;}else ba=t.getElementPosition(v('bottomContent')).y;m.scrollTo(new t(0,ba,'document'),aa!==false);},initUnhide:function(z,aa){g.listen(z,'click',function(event){var ba=o.byClass(aa,'fbCalendarItem');k.remove(aa);j.removeClass(k.find(ba,'.fbHiddenCalendarItem'),'fbHiddenCalendarItem');});},registerMonth:function(z,aa){if(!this._timestamp||aa>this._timestamp){this._months.push(z);}else this._months.unshift(z);this._timestamp=aa;},registerHomepageReminders:function(){if(!this._registeredReminders){h.subscribe(this.EVENT_ACTION,function(z,aa){if(w('pagelet_reminders'))s.loadFromEndpoint('RemindersPagelet','pagelet_reminders');});this._registeredReminders=true;}},registerTodayClickHandler:function(){this._todayButton.onclick=null;g.listen(this._todayButton,'click',this.scrollTo.bind(this,this._todayElement));},registerUpPagerButton:function(z){var aa=l.isNode(z)?z:w(z);j.removeClass(aa,'pvl');j.removeClass(aa,'hidden_elem');j.addClass(aa,'fbCalendarNoPadding');if(aa){this._upPager=v(aa.getElementsByTagName('a')[0]);}else this._upPager=null;},registerTodayElement:function(z){this._todayElement=l.isNode(z)?z:w(z);this._todayButton&&this.registerTodayClickHandler();},registerTodayButton:function(z){this._todayButton=z;this._todayElement&&this.registerTodayClickHandler();},registerEventLink:function(z,aa){h.subscribe(this.EVENT_ACTION,function(ba,ca){if(ca.eid===aa)switch(ca.action){case 'GOING':j.removeClass(z.parentNode,"hidden_elem");j.addClass(z,"fbCalendarEventGoing");break;case 'MAYBE':j.removeClass(z.parentNode,"hidden_elem");j.removeClass(z,"fbCalendarEventGoing");break;case 'DECLINED':case 'HIDDEN':n.hide(true);j.addClass(z.parentNode,"hidden_elem");break;case 'EDITED':if(ca.name)k.setContent(z,ca.name);if(ca.day){var da=w("pagelet_calendar_day_"+ca.day);if(da){var ea=l.find(da,".fbCalendarGridEventList");if(l.scry(ea,"li").length>=4){j.addClass(z.parentNode,"hidden_elem");s.loadFromEndpoint("CalendarDayPagelet","pagelet_calendar_day_"+ca.day,{day:ca.timestamp});}else k.prependContent(ea,z.parentNode);}else j.addClass(z.parentNode,"hidden_elem");}break;}});},informEventGoing:function(z,aa){h.inform(this.EVENT_ACTION,{eid:z,action:'GOING',actioncontext:aa});},informEventMaybe:function(z,aa){h.inform(this.EVENT_ACTION,{eid:z,action:'MAYBE',actioncontext:aa});},informEventDeclined:function(z,aa){h.inform(this.EVENT_ACTION,{eid:z,action:'DECLINED',actioncontext:aa});},informEventHidden:function(z,aa){h.inform(this.EVENT_ACTION,{eid:z,action:'HIDDEN',actioncontext:aa});},informEventEdited:function(z,aa,ba,ca){h.inform(this.EVENT_ACTION,{eid:z,action:'EDITED',name:aa,day:ba,timestamp:ca});},removeCalendarListHeader:function(z){var aa=k.scry(z,"^.fbCalendarOverlay .fbCalendarItem"),ba=k.find(z,"^.fbCalendarItem");if(aa.length==1)ba=k.find(z,"^.fbCalendarOverlay");k.remove(ba);},reloadPage:function(){x(window.location);},unhide:function(z){setTimeout(function(){q.monitor(z.nextSibling,j.show.bind(null,z));},0);}});e.exports=y;},null);
__d("XEventReminderImpressionLoggerAsyncController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/events\/ajax\/reminder\/impression\/",{acontext:{type:"StringToStringMap",required:true},data:{type:"StringToStringMap"}});},null);
__d("EventReminderController",["Arbiter","AsyncRequest","DOM","DOMQuery","Event","Scroll","ScrollableArea","XEventReminderImpressionLoggerAsyncController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o={registerReminder:function(p,q){this._firstOpen=true;var r=p.getDialog(),s=m.getInstance(j.scry(r.getRoot(),'.uiScrollableArea')[0]),t=null;if(s){t=i.find(s.getElement(),'div.uiScrollableAreaWrap');s.subscribe('scroll',function(){return g.inform('EventReminderDialog/scroll',{rect:t.getBoundingClientRect(),scrollTop:l.getTop(t)});});}k.listen(p.getRoot(),'click',function(event){event.preventDefault();});r.subscribe('show',function(){var u=n.getURIBuilder().setStringToStringMap('acontext',q).setStringToStringMap('data',{first_open:this._firstOpen}).getURI();new h(u).send();this._firstOpen=false;var v={};if(t)v={rect:t.getBoundingClientRect()};g.inform('EventReminderDialog/show',v);}.bind(this));r.subscribe('hide',function(){return g.inform('EventReminderDialog/hide');});}};e.exports=o;},null);
__d("FlexibleScrollableArea",["DataStore","DOM","DOMDimensions","Event","Parent","Run","Style","Vector","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=30,q=100;function r(s,t,u,v,w){"use strict";this._element=s;this._tight=t;this._measureFrom=u;this._minHeight=v;this._margin=w;g.set(this._element,'FlexibleScrollableArea',this);l.onLeave(this.cleanup.bind(this));this._listener=j.listen(window,'resize',o(this.poke,q,this));this.poke();}r.prototype.poke=function(){"use strict";var s=h.find(this._element,'.uiScrollableAreaBody'),t=n.getElementDimensions(s).y+i.measureElementBox(s,'height',true,true,true),u;if(this._tight){var v=this.getMaxHeight();if(t<v+p)v+=p;u=Math.max(Math.min(t,v),this._minHeight);}else u=Math.max(this.getMaxHeight(),this._minHeight);m.set(this._element,'height',u+'px');};r.prototype.getMaxHeight=function(){"use strict";if(this._measureFrom==='bottom'){var s=n.getViewportDimensions().y,t=n.getElementPosition(this._element,'viewport').y,u=s-t;return u-this._margin;}var v=n.getElementPosition(this._element,'viewport').y+n.getElementDimensions(this._element).y;return v-this._margin;};r.prototype.cleanup=function(){"use strict";this._listener&&this._listener.remove();};r.getInstance=function(s){"use strict";var t=k.byClass(s,'flexibleScrollableArea');return t?g.get(t,'FlexibleScrollableArea'):null;};e.exports=r;},null);
__d("LoadRecommendations",["Event","AsyncRequest"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={loadOnClick:function(j){g.listen(j,'click',function(){new h().setURI('/ajax/pages/reminder/recommendations').send();});}};e.exports=i;},null);
__d("ReminderStory",["AsyncRequest","Arbiter","DOMQuery","Event","FlexibleScrollableArea","LayerAutoFocus","ScrollableArea","SubscriptionsHandler","UIPagelet","getActiveElement"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();function q(r,s,t,u,v,w){"use strict";this.$ReminderStory0=false;this.$ReminderStory1=s;this.$ReminderStory2=r;j.listen(r,'click',function(event){if(t&&i.contains(t,event.target))return;s.show();if(u)new g('/growth/reminder/logging.php').setData({context_data:u,first_click:!this.$ReminderStory0}).send();this.$ReminderStory0=true;}.bind(this));if(v)s.subscribeOnce('show',function(){o.loadFromEndpoint(v,s.getContent(),w);});s.disableBehavior(l);s.subscribe('aftershow',function(){var x=s.getRoot(),y=i.scry(x,'#SuggestBelowInvite')[0];if(y)new g('/ajax/pages/reminder/recommendations').send();var z=s.hide.bind(s);this.$ReminderStory3=new n();this.$ReminderStory3.addSubscriptions(j.listen(window,'resize',z),j.listen(window,'scroll',z));var aa=i.scry(x,'.inlineReplyTextArea');aa[0]&&aa[0].focus();var ba=i.scry(x,'.jewelItemNew'),ca=[];ba.forEach(function(ga){var ha=ba[ga].getAttribute('id');if(ha&&ha.endsWith('_1_req'))ca=ca.concat(ha.replace('_1_req',''));});if(ca.length>0)new g('/friends/requests/log_impressions').setData({ids:ca.join(','),ref:'reminder_box'}).send();var da=m.getInstance(i.scry(s.getRoot(),'.uiScrollableArea')[0]),ea=k.getInstance(i.scry(s.getRoot(),'.flexibleScrollableArea')[0]),fa=function(){if(ea)ea.poke();if(da){da.poke();j.fire(i.scry(s.getRoot(),'.scrollable')[0],'scroll');}};fa();h.subscribe('reflow',function(){var ga=i.scry(x,'.fbRemindersBirthdayList');if(aa&&ga)for(var ha=0;ha<aa.length;++ha)if(aa[ha]==p()&&i.contains(ga[0],aa[ha]))fa();});}.bind(this));s.subscribe('beforehide',function(){if(this.$ReminderStory3){this.$ReminderStory3.release();this.$ReminderStory3=null;}}.bind(this));}q.prototype.getDialog=function(){"use strict";return this.$ReminderStory1;};q.prototype.getRoot=function(){"use strict";return this.$ReminderStory2;};e.exports=q;},null);