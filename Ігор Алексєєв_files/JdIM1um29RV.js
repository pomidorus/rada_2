/*!CK:689809661!*//*1437971733,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["tdf+2"]); }

__d("XFeedEgoImpressionLoggingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/ego\/feed\/logging\/impression\/",{ego_id:{type:"Int",required:true},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true}});},null);
__d("XFeedEgoLoadController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/ego\/feed\/load\/",{loading_id:{type:"String",required:true},ids:{type:"IntVector",required:true},service_id:{type:"String",required:true},replace_data:{type:"String",defaultValue:""},location:{type:"String",defaultValue:""},group_size:{type:"Int",defaultValue:1},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true}});},null);
__d("EgoUnitCarousel",["CSS","DOM","tidyEvent","Animation","Ease","XFeedEgoImpressionLoggingController","AsyncRequest","Arbiter","Locale","XFeedEgoLoadController","cx","csx","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=39;function u(v){"use strict";this.positionProperty=o.isRTL()?'margin-right':'margin-left';var w=v.elements;this.loggedItems={};this.itemWidth=v.item_width;this.visibleCount=v.visible_count;this.visibleIndex=0;this.position=v.start_offset;this.slideCount=3;this.carousel=w.node;this.grid=w.grid;this.grid.style[this.positionProperty]=this.position+'px';this.grid.style.width=this.itemWidth*this.visibleCount+'px';n.subscribe('x-out-ego-suggestions',this.onXout.bind(this));this.serviceID=w.service_id;this.pager=w.pager;this.enableAutoScrolling=v.enable_auto_scrolling;this.enableLargePager=v.enable_large_pager;this.prevPager=w.prev_pager;this.nextPager=w.next_pager;this.location=w.location;if(this.enableLargePager){i([s.listen(this.nextPager,'click',this.slideLeft.bind(this)),s.listen(this.prevPager,'click',this.slideRight.bind(this))]);}else i([this.pager.subscribe('next',this.slideLeft.bind(this)),this.pager.subscribe('prev',this.slideRight.bind(this))]);this.$EgoUnitCarousel0();this.$EgoUnitCarousel1();this.$EgoUnitCarousel2();}u.prototype.canSlideLeft=function(){"use strict";return this.visibleIndex+this.visibleCount<this.grid.childElementCount;};u.prototype.canSlideRight=function(){"use strict";return this.visibleIndex>=1;};u.prototype.$EgoUnitCarousel3=function(v){"use strict";var w=JSON.parse(v.getAttribute('data-ft'));if(!w)return;var x=w.ego_id;if(!x)return;if(this.loggedItems[x])return;var y=l.getURIBuilder().setInt('ego_id',x).setInt('qid',w.qid).setInt('mf_story_key',w.mf_story_key).getURI();new m().setURI(y).send();this.loggedItems[x]=true;};u.prototype.toggleXouts=function(v,w,x){"use strict";};u.prototype.$EgoUnitCarousel0=function(){"use strict";var v=this.grid.children,w=v.length,x=this.visibleIndex+Math.min(this.visibleCount,w)-1;if(x===(w-1))--x;for(var y=this.visibleIndex;y<=x;++y)this.$EgoUnitCarousel3(v[y]);};u.prototype.onXout=function(v,w){"use strict";if(!w)return;if(this.grid.childElementCount===0){h.remove(this.carousel);return;}if(this.grid.childElementCount>=this.visibleCount){var x=this.visibleIndex+this.visibleCount,y=this.grid.childElementCount-x;if(y<0)this.slide(-y);}this.$EgoUnitCarousel2();this.$EgoUnitCarousel0();this.$EgoUnitCarousel1();};u.prototype.$EgoUnitCarousel2=function(){"use strict";this.toggleXouts(this.visibleIndex,this.visibleIndex+this.visibleCount-1,false);if(this.enableAutoScrolling)this.updateAutoSlideListener();if(this.enableLargePager){this.updateLargePager();return;}if(this.grid.childElementCount<this.visibleCount){this.pager.setNextEnabled(false);this.pager.setPrevEnabled(false);return;}this.pager.setNextEnabled(this.canSlideLeft());this.pager.setPrevEnabled(this.canSlideRight());};u.prototype.slide=function(v){"use strict";this.toggleXouts(this.visibleIndex,this.visibleIndex+this.visibleCount,true);var w=0;if((this.enableAutoScrolling||this.enableLargePager)&&this.visibleIndex===0&&v>0)w=-t;var x=this.visibleIndex+v;if(x<=0){x=0;if(this.enableAutoScrolling||this.enableLargePager)w=t;}if(x+this.visibleCount>=this.grid.childElementCount)x=this.grid.childElementCount-this.visibleCount;v=x-this.visibleIndex;if(x===this.visibleIndex)return;this.position-=v*this.itemWidth+w;this.visibleIndex=x;var y=Math.abs(v*this.itemWidth);if(this.enableLargePager)g.addClass(this.carousel,"_4iwv");new j(this.grid).to(this.positionProperty,this.position).duration(y).ease(k.sineOut).ondone(this.$EgoUnitCarousel2.bind(this)).go();};u.prototype.slideRight=function(){"use strict";this.slide(-this.slideCount);};u.prototype.slideLeft=function(){"use strict";this.slide(this.slideCount);this.$EgoUnitCarousel0();this.$EgoUnitCarousel1();};u.prototype.$EgoUnitCarousel1=function(){"use strict";if(this.hasReq)return;var v=this.grid.childElementCount-this.visibleIndex-this.visibleCount-1;if(v>7)return;var w=h.scry(this.grid,"._34bp")[0];if(!w)return;var x=w.id,y=[],z=this.grid.childNodes,aa=z.length-1,ba,ca;for(var da=0;da<aa;++da){var ea=JSON.parse(z[da].getAttribute('data-ft'));if(ea.ego_id)y.push(ea.ego_id);if(ea.qid&&!ba)ba=ea.qid;if(ea.mf_story_key&&!ca)ca=ea.mf_story_key;}var fa=p.getURIBuilder().setString('service_id',this.serviceID).setString('location',this.location).setString('loading_id',x).setIntVector('ids',y).setInt('qid',ba).setInt('mf_story_key',ca).getURI();new m().setURI(fa).setHandler(this.onDone.bind(this)).setErrorHandler(this.onError.bind(this)).send();this.hasReq=true;};u.prototype.onDone=function(v){"use strict";this.hasReq=false;if(v&&v.payload&&v.payload.items){var w=v.payload.items;if(w){var x=h.find(this.grid,"._34bp");h.insertBefore(x,w);this.$EgoUnitCarousel2();this.$EgoUnitCarousel0();this.$EgoUnitCarousel1();}}};u.prototype.onError=function(){"use strict";this.hasReq=false;};e.exports=u;},null);
__d("PYMKUnitCarousel",["CSS","DOM","Event","csx","debounce","cx","EgoUnitCarousel"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(){"use strict";if(m!==null)m.apply(this,arguments);}p.prototype.updateAutoSlideListener=function(){"use strict";this.$PYMKUnitCarousel0();if(this.canSlideLeft())this.$PYMKUnitCarousel1('left',this.visibleIndex+this.visibleCount);if(this.canSlideRight())this.$PYMKUnitCarousel1('right',this.visibleIndex-1);};p.prototype.updateLargePager=function(){"use strict";g.removeClass(this.carousel,"_4iwv");this.$PYMKUnitCarousel2(true);this.$PYMKUnitCarousel2(false);g.conditionClass(this.carousel,"_4iww",this.canSlideLeft()&&this.canSlideRight());};p.prototype.$PYMKUnitCarousel2=function(q){"use strict";var r=q?"_4iwx":"_4iwy",s=q?"_4iwz":"_4iw-";if(q?this.canSlideRight():this.canSlideLeft()){g.removeClass(this.carousel,s);g.removeClass(this.carousel,r);}else{g.addClass(this.carousel,s);setTimeout(function(){g.addClass(this.carousel,r);}.bind(this),500);}};p.prototype.$PYMKUnitCarousel0=function(){"use strict";if(this.$PYMKUnitCarousel3)this.$PYMKUnitCarousel3.remove();this.$PYMKUnitCarousel3=null;if(this.$PYMKUnitCarousel4)this.$PYMKUnitCarousel4.remove();this.$PYMKUnitCarousel4=null;if(this.$PYMKUnitCarousel5)this.$PYMKUnitCarousel5.remove();this.$PYMKUnitCarousel5=null;if(this.$PYMKUnitCarousel6)this.$PYMKUnitCarousel6.remove();this.$PYMKUnitCarousel6=null;};p.prototype.$PYMKUnitCarousel1=function(q,r){"use strict";if(isNaN(r)||q!=='left'&&q!=='right')return;if(q==='left'){var s=k(this.slideLeft.bind(this),1000,this);this.$PYMKUnitCarousel3=i.listen(this.grid.children[r],'mouseover',s);this.$PYMKUnitCarousel5=i.listen(this.grid.children[r],'mouseout',function(){s.reset();});}else{var t=k(this.slideRight.bind(this),1000,this);this.$PYMKUnitCarousel4=i.listen(this.grid.children[r],'mouseover',t);this.$PYMKUnitCarousel6=i.listen(this.grid.children[r],'mouseout',function(){t.reset();});}};p.prototype.toggleXouts=function(q,r,s){"use strict";var t=Math.min(q,r),u=Math.max(q,r),v=this.grid.children;t=Math.max(t,0);u=Math.min(u,v.length-1);var w;for(var x=t;x<=u;++x){w=v[x];var y=h.scry(w,"._l98")[0];if(y)if(s){g.hide(y);}else g.show(y);}};e.exports=p;},null);
__d("XEgoHideLoggingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/ego\/feed\/logging\/xout\/",{ego_id:{type:"Int",required:true},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true},service_id:{type:"String",required:true}});},null);
__d("PymkXout",["Event","DOM","CSS","Arbiter","XEgoHideLoggingController","AsyncSignal"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={init:function(n,o,p){g.listen(o,'click',function(event){this._logForItem(n);if(p==='pymk_jewel'||p==='pymk_jewel_first_page'){i.hide(n);}else h.remove(n);var q=event.getTarget().getAttribute('data-pymk-id');if(q)j.inform('x-out-ego-suggestions',{id:q});}.bind(this));},_logForItem:function(n){var o=JSON.parse(n.getAttribute('data-ft'));if(!o)return;if(!o.ego_id)return;var p=k.getURIBuilder().setInt('ego_id',o.ego_id).setInt('qid',o.qid).setInt('mf_story_key',o.mf_story_key).setString('service_id','PYMK').getURI();new l(p,{}).send();}};e.exports=m;},null);