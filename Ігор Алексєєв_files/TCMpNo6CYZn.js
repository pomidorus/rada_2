/*!CK:2161182544!*//*1438569943,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["V8897"]); }

__d("PhotosUploadWaterfallErrorCodes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SECURITY:1,FILE_IO:2,IMAGE_IO:3,UPLOAD_IO:4,INVALID_SERVER_RESULT:5,RESIZE_FAILURE:6,ENCODE_FAILURE:7,INVALID_DOMAIN:8,BAD_JPEG_MARKERS:9,BAD_SERVER_RESPONSE:10,EXTERNAL_INTERFACE_UNAVAILABLE:11,JS_CALL_FAILED:12,UNCAUGHT_ERROR:13,UPLOAD_SWF_FAILED_LOAD:14,FILE_IO_TIMEOUT:15,IMAGE_SECURITY:16,BAD_IMAGE_FILE:17,IMAGE_IO_TIMEOUT:18,BLACK_PHOTO:19,EMPTY_FILE_LOADED:20,FILE_READ_DISABLED:21,BAD_NETWORK:22,FLASH_LOAD_TIMEOUT:23,FLASH_LOAD_FAILURE:24,FLASH_UPGRADE_REQUIRED:25};},null);
__d("ImageResizer",["ArbiterMixin","BlobFactory","DOM","UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(l,m,n,o,p){this._input=l;this._image=null;this._canvas=null;this._rotation=0;this._maxWidth=m;this._maxHeight=n;this._outputMime=o||'image/jpeg';this._outputQuality=(p===(void 0))?.87:p;};k.isSupported=function(){if(window.File&&window.FileReader){var l=i.create('canvas');if(l.toBlob||(l.toDataURL&&window.ArrayBuffer&&window.Uint8Array&&h.isSupported()))return true;}return false;};Object.assign(k.prototype,g);Object.assign(k.prototype,{setOrientation:function(l){this._rotation={1:0,3:180,6:90,8:270}[l]||0;},resize:function(){if(this._input instanceof HTMLCanvasElement||this._input instanceof HTMLImageElement){this._image=this._input;this._handleImage();}else if(typeof this._input=="string"){this._loadImage(this._input);}else if(this._input instanceof window.File)this._loadFile(this._input);},_rotatedToSide:function(){return (this._rotation%180)==90;},_prepareError:function(l){return (function(){this.inform.bind(this,"error",l);}.bind(this));},_loadFile:function(l){this._fileLoadTime=Date.now();var m=new FileReader();m.onload=this._handleFile.bind(this);m.onerror=this._prepareError("Could not read tile.");m.readAsDataURL(l);},_handleFile:function(event){this._fileLoadTime=Date.now()-this._fileLoadTime;var l=event.target.result;this._loadImage(l);},_loadImage:function(l){this._imageLoadTime=Date.now();this._image=i.create('img');this._image.onload=this._handleImage.bind(this);this._image.onerror=this._prepareError("Could not load image.");this._image.src=l;},_handleImage:function(){if(this._imageLoadTime)this._imageLoadTime=Date.now()-this._imageLoadTime;if(this._input instanceof window.File){var l=this._calculateRatio();if(l>=1){this._skippedResizing=true;return this._handleBlob(this._input);}}this._skippedResizing=false;this._drawTransformed();this._extractBlob();},_drawTransformed:function(){var l=Date.now(),m=this._calculateRatio(),n=0;if(j.chrome())if(m<.25){n=2;}else if(m<.5)n=1;var o=this._drawResizedCanvas(this._image,m*Math.pow(2,n));for(var p=0;p<n;p++)o=this._drawResizedCanvas(o,.5);if(this._rotation)o=this._drawRotatedCanvas(o);this._canvas=o;this._drawTime=Date.now()-l;},_drawResizedCanvas:function(l,m){var n=i.create('canvas');n.width=l.width*m;n.height=l.height*m;var o=n.getContext("2d");o.scale(m,m);o.drawImage(l,0,0);return n;},_drawRotatedCanvas:function(l){var m=i.create('canvas');if(this._rotatedToSide()){m.width=l.height;m.height=l.width;}else{m.width=l.width;m.height=l.height;}var n=m.getContext("2d");n.translate(m.width*.5,m.height*.5);n.rotate(Math.PI*(this._rotation/180));n.translate(l.width*-.5,l.height*-.5);n.drawImage(l,0,0,l.width,l.height);return m;},_calculateRatio:function(){var l=1,m=this._rotatedToSide()?this._maxHeight:this._maxWidth,n=this._rotatedToSide()?this._maxWidth:this._maxHeight,o=m/this._image.width,p=n/this._image.height;if(o<l&&o>0)l=o;if(p<l&&p>0)l=p;return l;},_extractBlob:function(){this._extractionStart=Date.now();if(this._canvas.toBlob){this._canvas.toBlob(this._handleBlob.bind(this),this._outputMime,this._outputQuality);return;}var l=this._canvas.toDataURL(this._outputMime,this._outputQuality),m=l.match(/^data:(.*?);base64,/);if(!m){this._prepareError("Couldn't get base64 encoded data from canvas.")();return;}var n=m[1],o=l.substr(m[0].length),p=window.atob(o),q=new ArrayBuffer(p.length),r=new Uint8Array(q);for(var s=0;s<p.length;s++)r[s]=p.charCodeAt(s);var t=h.getBlob([q],{type:n});this._handleBlob(t);},_handleBlob:function(l){this._canvas=this._canvas||i.create('canvas');l.performanceData={blockingDraw:+true,blockingExtraction:+!this._canvas.toBlob,imageLoadTime:this._imageLoadTime,fileLoadTime:this._fileLoadTime,skippedResizing:+this._skippedResizing};if(!this._skippedResizing)Object.assign(l.performanceData,{extractionTime:Date.now()-this._extractionStart,drawTime:this._drawTime});this.inform('resized',l);}});e.exports=k;},null);
__d("ComposerXMediaPostTab",["Arbiter","ComposerXMediaUploadHandler","Event"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k,l){"use strict";g.inform('composer/reset_pab_nux');var m=new h(k);i.listen(l.getContainer(),'click',function(){g.inform('composerprivacy/aborteducation');m.fetchAttachments();l.getInput().disabled=false;});l.subscribe('change',function(){m.handleFileSelected(l);});}e.exports=j;},null);
__d("EntstreamStoryDeduper",["DOM","csx","CSS"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(l,m){var n={};for(var o=0;o<l.length;o++){var p=l[o],q=p.getAttribute('data-dedupekey');if(n[q]){if(m){i.hide(p);}else g.remove(p);}else n[q]=1;}}var k={dedupe:function(l,m){m=m||"._5jmm";var n=g.scry(l,m);n=n.filter(function(o){return o.getAttribute('data-dedupekey');});j(n,false);},dedupeHide:function(l,m){m=m||"._5jmm";var n=g.scry(l,m),o=n.filter(function(p){return p.getAttribute('data-dedupekey')&&i.shown(p);});j(o,true);}};e.exports=k;},null);
__d("FeedLiveUpdateBar",["ArbiterMixin","Animation","BanzaiScuba","CurrentUser","Ease","DOM","DOMScroll","Event","Vector","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=300,r=false;function s(u){this.element=u;this.init();}function t(u){new i('feed_newstoriescard').addNormal('user_id',j.getID()).addNormal('event',u).addInteger('time',Math.round(Date.now()/1000)).addInteger('bar_at_top',1).post();}Object.assign(s.prototype,g,{init:function(){if(!this.element)return;this.hide();var u=l.find(this.element,"._2f6b");n.listen(u,'click',this._handleClick.bind(this));},_handleClick:function(event){if(r)t('click');this.hide();var u=new o(o.getScrollPosition().x,0,'document');m.scrollTo(u,q,false,false,0,function(){m.scrollTo(u,0);this.inform('click');}.bind(this));event.kill();},setAtTop:function(){r=true;},hide:function(){r=false;new h(this.element).from('top',42).to('top',-50).ease(k.sineOut()).duration(250).hide().go();},show:function(){if(!this.element)return;new h(this.element).from('top',-50).to('top',42).ease(k.makePowerOut(3)).duration(400).show().go();if(r)t('render');}});e.exports=s;},null);
__d("runAfterScrollingStops",["Arbiter","Event","Run","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(w,x,y){if(x&&o[x])return;if(!n){g.subscribe('page_transition',v);n=true;}if(!m){w();return;}x&&(o[x]=1);p.push(w);if(!y){if(r){i.onLeave(v);r=false;}q.push(p.length-1);}}var m,n,o={},p=[],q=[],r=true,s=500,t=j(function(){m=false;var w=p;p=[];q=[];o={};for(var x=0,y=w.length;x<y;++x)w[x]();},s);function u(){m=true;t();}function v(){var w=q;q=[];r=true;for(var x=0,y=w.length;x<y;++x)p[w[x]]=k;}h.listen(window,'scroll',u);e.exports=l;},null);
__d("LitestandOffscreenController",["Arbiter","CSS","DOMQuery","Event","NavigationMessage","Run","Scroll","Style","SubscriptionsHandler","Vector","cx","csx","getOrCreateDOMID","queryThenMutateDOM","runAfterScrollingStops","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=1,x=9,y=10,z={},aa=false,ba,ca,da,ea,fa=[];function ga(){ba&&ba.release();ba=null;aa=false;}function ha(){z={};fa=[];}function ia(){if(h.hasClass(document.body,"_5vb_"))return y;return x;}function ja(){ea=ea||p.getViewportDimensions().y;ca=p.getScrollPosition().y;da=ca+ea;if(w){ca-=ea*w;da+=ea*w;}for(var ra in z){var sa=z[ra];sa.position=p.getElementPosition(sa.element).y;if(!sa.hidden)sa.height=sa.element.offsetHeight;}}function ka(){var ra=[];for(var sa in z){var ta=z[sa],ua=ta.position,va=ua+ta.height<ca,wa=ua>da;if(!ta.hidden&&(va||wa)){la(ta);}else if(!va&&!wa){ta.pendingHide=false;if(ta.hidden){if(ta.dirty&&ua<ca){ra.push(sa);h.addClass(ma(ta),"_49nu");}else n.apply(ta.element,{height:'',marginBottom:''});h.show(ma(ta));ta.dirty=false;ta.hidden=false;}}}if(!ra.length)return;var xa=0;t(function(){for(var ya=0,za=ra.length;ya<za;ya++){var ab=z[ra[ya]];xa+=ab.height-ma(ab).offsetHeight+n.getFloat(ab.element,'marginBottom');}},function(){for(var ya=0,za=ra.length;ya<za;ya++){var ab=z[ra[ya]];h.removeClass(ma(ab),"_49nu");n.apply(ab.element,{height:'',marginBottom:''});}xa&&(m.setTop(document.body,m.getTop(document.body)-xa));});}function la(ra){if(!ra.pendingHide){fa.push(ra);ra.pendingHide=true;}}function ma(ra){if(ra.wrapperElement)return ra.wrapperElement;var sa=ra.element;if(sa.firstElementChild)return (ra.wrapperElement=sa.firstElementChild);for(var ta=0;ta<sa.childNodes.length;ta++)if(sa.childNodes[ta].tagName)return (ra.wrapperElement=sa.childNodes[ta]);}function na(){var ra=ia()+'px';for(var sa=0;sa<fa.length;sa++){var ta=fa[sa];if(i.scry(ta.element,"._52fb").length)ta.pendingHide=false;if(ta&&ta.element&&ta.pendingHide&&!ta.hidden){n.apply(ta.element,{height:ta.height+'px',marginBottom:ra});h.hide(ma(ta));ta.hidden=true;ta.pendingHide=false;}}fa=[];}function oa(){u(na,'LitestandOffscreenController/hide');t(ja,ka,'LitestandOffscreenController');}function pa(){l.onLeave(ga);ba=new o();ba.addSubscriptions(g.subscribe(k.NAVIGATION_BEGIN,ha),j.listen(window,'scroll',v(oa)),j.listen(window,'resize',v(function(){ea=null;oa();})));aa=true;}var qa={attachSubstream:function(ra){aa||pa();z[s(ra)]={element:ra};}};e.exports=qa;},null);
__d("LitestandNewStoryController",["Animation","Arbiter","AsyncRequest","CSS","csx","DOMQuery","Event","LitestandMessages","LitestandStream","NavigationMessage","Run","Style","SubscriptionsHandler","UITinyViewportAction","ge","getScrollPosition","memoize","$","queryThenMutateDOM","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa=1,ba,ca,da=500,ea=600,fa,ga;function ha(){ga&&clearTimeout(ga);ga=null;}function ia(){ga=setTimeout(function(){ga=null;ja();},da);}function ja(){var db;y(function(){db=o.canInsertNewerStories();},function(){if(db){ab();}else ia();},'LitestandNewStoryController/tryShowingStories');}var ka=0,la,ma=true,na;function oa(){if(!na){na=new s();na.addSubscriptions(h.subscribe(p.NAVIGATION_BEGIN,xa),m.listen(window,'resize',pa),m.listen(window,'scroll',va));q.onLeave(xa);}}function pa(){if(!ra())xa();}var qa=w(function(){var db=u('blueBarNAXAnchor');return db&&j.hasClass(db,'fixed_elem');});function ra(){return qa()&&!t.isTiny();}function sa(){return l.scry(document,"div._vox").length;}function ta(db,eb){var fb=u(db);if(fb)fb.style.marginTop=eb?eb+'px':'';}function ua(db){if(!ra()){db=0;}else db=Math.max(db,0);ka=db;ta('rightCol',db);if(!sa())ta('leftCol',db);}function va(){var db=v(window).y;if(db<=0){xa();return;}if(db<ka){ma=false;ua(db);}if(ca&&db>ca+50&&ba){ba.hide();ca=null;}ca=db;}function wa(){if(!ma){la&&la.stop();la=null;}}function xa(){if(na){na&&na.release();ma=false;ua(0);na=null;if(ba){ba.hide();ca=null;}}}function ya(db,eb){la=new g(db).from('opacity',0).to('opacity',1).duration(ea);if(eb){ma=true;for(var fb=0;fb<aa;fb++)la.checkpoint(1,wa).from('opacity',1).to('opacity',0).duration(ea).checkpoint().from('opacity',0).to('opacity',1).duration(ea);}la.go();}function za(db){ha();if(!fa)return;if(db)var eb=v(window),fb=fa.nextSibling,gb=fb.offsetTop,hb=function(){ua(eb.y+fb.offsetTop-gb);window.scrollTo(eb.x,ka);};r.apply(fa,{height:'',left:'',overflow:'',position:'',width:''});if(db){hb();var ib=fa;z(function(){oa();hb();ya(ib,true);if(ba){ba.setAtTop();ba.show();}});}else ya(fa,false);h.inform(n.STORIES_INSERTED);h.inform(n.NEWER_STORIES_INSERTED);setTimeout(function(){h.inform('reflow');},0);new i().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:o.getSectionID()}).send();fa=null;h.inform(n.NEW_STORIES_DISPLAYED);}function ab(){za(ra());}function bb(){za(false);}var cb={waitForDisplay:function(db){if(!fa)fa=x(db);if(o.canInsertNewerStories()){ab();}else ia();},showStoriesNow:function(db){fa=db;bb();},setNewStoryPill:function(db){ba=db;}};e.exports=cb;},null);
__d("ViewportAtFeedTop",["getElementPosition","LitestandStream","ViewportBounds"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={isTrue:function(){if(i.getTop()>g(h.getStreamRoot()).y)return false;return true;}};e.exports=j;},null);
__d("LitestandStreamLoader",["Arbiter","Bootloader","CSS","DOM","EntstreamStoryDeduper","Event","JSXDOM","LitestandStreamConfig","LitestandStoryInsertionStatus","LitestandMessages","LitestandOffscreenController","LitestandStream","NavigationMessage","OnVisible","Run","throttle","UserActivity","$","ge","getElementPosition","getViewportDimensions","getUnboundedScrollPosition","ForceFetchAfterLongInactiveQE","NewStoriesPillConfig","ViewportAtFeedTop","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){b.__markCompiled&&b.__markCompiled();var ga=0,ha=false,ia={},ja,ka,la,ma,na,oa,pa,qa=0,ra,sa,ta=[],ua=60000,va=30,wa=200,xa=0,ya,za;function ab(){u.onLeave(bb);ga=0;ta=[g.subscribe(s.NAVIGATION_BEGIN,bb),g.subscribe(p.NEWER_STORIES_INSERTED,function(){za=null;}),g.subscribe('useractivity/focus',function(){var sb=Date.now()-w.getLastLeaveTime(),tb=va*ua,ub=wa*ua;if(ca.forceRefresh&&o.canInsert())if(sb>ub){window.location.href=window.location.href;}else if(sb>tb){var vb=new fa('/home.php');vb.go();}})];if(da.no_insert_when_dialog){ta.push(g.subscribe('layer_shown',function(sb,tb){if(tb&&tb.type==='DialogX')ga++;}),g.subscribe('layer_hidden',function(sb,tb){if(tb&&tb.type==='DialogX')ga--;}));o.registerBlocker(function(){return ga>0;});}ha=true;}function bb(){g.inform(p.LEAVE_HOME);ia={};sa=null;qa=0;ta.forEach(g.unsubscribe);ta=[];ja&&ja.remove();na&&clearTimeout(na);na=null;oa&&clearTimeout(oa);oa=null;ma=null;za=null;ra&&ra.remove();ra=null;ha=false;xa=0;}function cb(sb){oa&&clearTimeout(oa);oa=setTimeout(function(){oa=null;jb(false);},sb);}function db(sb){na&&clearTimeout(na);na=setTimeout(function(){na=null;jb(true);},sb);}function eb(){if(sa&&ma&&sa.pollIntervalMS&&sa.pollIntervalMS>1000){w.setIdleTime(sa.newStoryIdleTime);db(sa.pollIntervalMS);if(da.show_new_stories_pill)cb(da.middle_feed_polling_time);}}function fb(){ja=new t(j.find(ka,'a'),qb.bind(null),false,sa.bufferPixels);}function gb(){var sb=ba(window).y;return sb>sa.firstPagerScrollBuffer;}function hb(){if(gb()){fb();ra&&ra.remove();ra=null;}}function ib(sb){var tb=j.find(ka,'a');l.listen(tb,'click',function(event){qb();ra&&ra.remove();ra=null;event.preventDefault();});var ub=z(ka),vb=aa();if(sb&&ub.y<vb.height){qb();}else if(sb&&!gb()){ra=l.listen(window,'scroll',v(hb));}else fb();}function jb(sb){if(!ma)return;if(!w.isActive(sa.newStoryIdleTime)){w.subscribeOnce(jb.bind(null,sb));return;}if(w.hasBeenInactive()){w.resetActiveStatus();var tb=sa.pollIntervalMS,ub=Date.now()-w.getLastInActiveEnds();if(ub<tb){if(sb){db(tb-ub);}else cb(tb-ub);return;}}if(sb){if(!r.canInsertNewerStories()){db(sa.pollIntervalMS);return;}}else if(ea.isTrue()||!o.canInsert()){cb(da.middle_feed_polling_time);return;}kb(false);}function kb(sb){if(!ma)return;na&&clearTimeout(na);oa&&clearTimeout(oa);if(!za){var tb=r.getStreamRoot();za=m.div({style:{height:0,width:tb.offsetWidth+'px',left:'-10000px',opacity:0,overflow:'hidden',position:'absolute'}});j.prependContent(tb,za);g.inform(p.NEW_STORIES_CONTAINER_CREATED,za);}var ub=m.div(null);j.prependContent(za,ub);h.loadModules(["UIPagelet"],function(vb){vb.loadFromEndpoint('LitestandNewerStoriesPagelet',ub,Object.assign(ma,{cursor:ya,containerID:j.getID(za),fblogo:sb}),{crossPage:true});});g.inform(p.PILL_PAGELET_REQUEST_SENT);}function lb(){var sb=j.getID(ka);i.addClass(ka,'async_saving');var tb=ob(),ub=tb.cursor,vb=tb.storiesCount;if(ia[ub])throw new Error('This cursor has been used before, stories will be '+'repeated. Cursor: '+ub);ia[ub]=ub;var wb={cursor:ub,pager_config:la,pager_id:sb,scroll_count:++qa,feed_stream_id:r.getFeedStreamID(),client_stories_count:vb};h.loadModules(["UIPagelet"],function(xb){xb.loadFromEndpoint(sa.pagerController,j.getID(pa),wb,{append:true,automatic:true,usePipe:true,crossPage:sa.crossPage,errorHandler:mb,transportErrorHandler:mb});});}function mb(sb){var tb=ob();delete ia[tb.cursor];i.removeClass(ka,'async_saving');}function nb(){var sb=pb();if(sb.length){return sb[0].getAttribute('data-cursor');}else return ka&&ka.getAttribute('data-cursor');}function ob(){var sb=pb(),tb={};if(sb.length){tb.cursor=sb[sb.length-1].getAttribute('data-cursor');tb.storiesCount=sb.length;}else{tb.cursor=ka&&ka.getAttribute('data-cursor');tb.storiesCount=0;}return tb;}function pb(){var sb=j.scry(pa,r.getStoriesSelector());return sb.filter(function(tb){return tb.getAttribute('data-cursor');});}function qb(){lb();ja&&ja.remove();ja=null;}var rb={register:function(sb,tb,ub,vb){ha||ab();sa=Object.assign({bufferPixels:1000,firstPagerScrollBuffer:100,pagerController:'LitestandMoreStoriesPagelet',pollIntervalMS:null,newStoryIdleTime:60000},tb);la=ub;pa=x(sb);ya=nb();ka=vb;ib(true);eb();},removeOldPager:function(sb,tb){if(sb)j.remove(x(sb));i.show(x(tb));},removeLoadingIndicator:function(sb,tb){var ub=y(sb);if(ub)j.remove(ub);i.show(tb);},moreStoriesInserted:function(sb){g.inform(p.STORIES_INSERTED,{substream_id:sb});var tb=x(sb);if(n.hide_offscreen_substreams)q.attachSubstream(tb);},attachNewPager:function(sb){k.dedupeHide(r.getStreamRoot(),r.getStoriesSelector());ka=sb;ka&&ib(false);},setPollerData:function(sb){if(sb){ma=sb;eb();}},headLoadCompleted:function(sb){ya=sb.newCursor;eb();var tb=sb.stories;if(tb&&tb.length>0){for(var ub=tb.length-1;ub>=0;ub--)tb[ub].setAttribute('data-insertion-position',--xa);var vb=r.getStoriesSelector();k.dedupe(r.getStreamRoot(),vb);var wb=j.scry(za,vb);g.inform('Stream/totalHeadLoadedStories',{count:-xa,hiddenCount:wb.length,fblogo:sb.fblogo});}},forceNewFetch:function(){kb(true);}};e.exports=rb;},null);
__d("collectSubtreeData",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(i,j,k,l,m){if(i.offsetWidth===0&&i.offsetHeight===0)return m;var n={};if(i.getAttribute)for(r=0;r<j.length;r++){t=j[r];var o=i.getAttribute(k[t]);if(o){n[t]={};var p=JSON.parse(o);for(var q in l)if(p[q]!==(void 0)){n[t][q]=true;if(m[t]===(void 0))m[t]={};if(m[t][q]===(void 0))m[t][q]=[];if(l[q].length>0)m[t][q].push(l[q]);m[t][q].push('('+p[q]);}}}for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r];g(s,j,k,l,m);}for(var t in n)for(var u in n[t]){var v=m[t][u][m[t][u].length-1];if(v.length>0&&v.charAt(0)=='('){m[t][u][m[t][u].length-1]=v.substr(1);}else m[t][u].push(')');}return m;}function h(i,j){var k={};for(var l=0;l<j.length;++l)k[j[l]]='data-'+j[l];var m={tn:"","tn-debug":","},n={};g(i,j,k,m,n);for(var o in n)for(var p in n[o])n[o][p]=n[o][p].join('');return n;}e.exports=h;},null);
__d("recordTNTreeData",["collectSubtreeData"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i,j){var k={},l=g(i,['ft']);for(var m in l.ft){k[m+'_tree']=l.ft[m];if(m==='tn-debug')i.setAttribute('tn-debug_subtree',l.ft[m]);}k.evt_value=i.offsetHeight;if(j)k.offset=Math.max(0,i.offsetTop-j.offsetTop);return k;}e.exports=h;},null);
__d("PhotosUploadWaterfallMixin",["Flash","PhotosUploadWaterfall","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=i,k={getUploaderApp:j,getWaterfallID:j,getAdditionalData:function(){return {};},logWaterfallStep:function(l,m,n){h.sendSignal(Object.assign({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:l,flash_version:g.getVersionString(),ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),m),n);},logWaterfallStepUsingBanzai:function(l,m,n){h.sendBanzai(Object.assign({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:l,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),m),n);}};e.exports=k;},null);
__d("PhotoSourceTypes",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();e.exports=g({COMPUTER:null,POSTED_PHOTOS:null,SYNCED_PHOTOS:null,SUGGESTIONS:null,PAGES_POSTED_PHOTOS:null});},null);
__d("BaseSelectionContainer",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=0;function h(){"use strict";this.$BaseSelectionContainer0=(g++).toString();}h.prototype.getSelectionContainerID=function(){"use strict";return this.$BaseSelectionContainer0;};h.prototype.getSource=function(){"use strict";throw 'This must be implemented by the child class';};h.prototype.getName=function(){"use strict";return null;};h.prototype.getSize=function(){"use strict";return null;};h.prototype.hasPlaceholderUI=function(){"use strict";throw 'This must be implemented by the child class';};e.exports=h;},null);
__d("SelectionSource",["PhotoSourceTypes"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={FILE:'file',FLASH:'flash',VAULT:'vault',SUGGESTIONS:'suggestions',POSTED_PHOTOS:'posted_photos',PAGES_POSTED_PHOTOS:'pages_posted_photos',toPhotoSourceType:function(i){switch(i){case h.FILE:case h.FLASH:return g.COMPUTER;case h.VAULT:return g.SYNCED_PHOTOS;case h.SUGGESTIONS:return g.SUGGESTIONS;case h.POSTED_PHOTOS:return g.POSTED_PHOTOS;case h.PAGES_POSTED_PHOTOS:return g.PAGES_POSTED_PHOTOS;default:throw 'No mapping for SelectionSource: '+i;}}};e.exports=h;},null);
__d("FileSelectionContainer",["BaseSelectionContainer","SelectionSource"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();for(var i in g)if(g.hasOwnProperty(i))k[i]=g[i];var j=g===null?null:g.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=g;function k(l){"use strict";g.call(this);this.$FileSelectionContainer0=l;}k.prototype.getFile=function(){"use strict";return this.$FileSelectionContainer0;};k.prototype.getSource=function(){"use strict";return h.FILE;};k.prototype.getName=function(){"use strict";return this.$FileSelectionContainer0.fileName||this.$FileSelectionContainer0.name;};k.prototype.getSize=function(){"use strict";return this.$FileSelectionContainer0.fileSize||this.$FileSelectionContainer0.size;};k.prototype.hasPlaceholderUI=function(){"use strict";return false;};e.exports=k;},null);
__d("FilePickerEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={BEGIN:'FilePickerEvent/BEGIN',SELECT_START:'FilePickerEvent/SELECT_START',SELECTED:'FilePickerEvent/SELECTED_FILES',ALBUM_LIMIT_EXCEEDED:'FilePickerEvent/ALBUM_LIMIT_EXCEEDED',SESSION_LIMIT_EXCEEDED:'FilePickerEvent/SESSION_LIMIT_EXCEEDED',SELECT_CANCELED:'FilePickerEvent/SELECT_CANCELED',FALLBACK:'FilePickerEvent/FALLBACK'};},null);
__d("FlashArbiterEvents",["Arbiter","Run"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this._flashID=j;this._subscriptions=[];h.onLeave(this.unsubscribeAll.bind(this));}i.prototype.subscribe=function(j,k){"use strict";var l=this._flashID;this._subscriptions.push(g.subscribe(j,function(m,n){if(l===n.divID)k(n);}));return this;};i.prototype.unsubscribeAll=function(){"use strict";while(this._subscriptions.length)g.unsubscribe(this._subscriptions.pop());};e.exports=i;},null);
__d("compareFlashVersions",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(i){return i.replace(/\d+/g,function(j){return '000'.substring(j.length)+j;});}function h(i,j){i=g(i);j=g(j);if(i>j){return 1;}else if(i<j)return -1;return 0;}e.exports=h;},null);
__d("FlashLoadEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={READY:'flash/ready',FAILED:'flash/failed',MOUSE_CANCELED:'UploadEvent/SELECT_CANCELED',MOUSE_DOWN:'UploadEvent/SELECT_DOWN',MOUSE_OUT:'UploadEvent/SELECT_OUT',MOUSE_OVER:'UploadEvent/SELECT_OVER',MOUSE_UP:'UploadEvent/SELECT_UP',ERROR_FLASH_LOAD_TIMEOUT:1,ERROR_FLASH_LOAD_FAILURE:2,ERROR_FLASH_UPGRADE_REQUIRED:3};},null);
__d("UploadEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={UPLOAD_START:'UploadEvent/UPLOAD_START',UPLOAD_HIRES_RESTART:'UploadEvent/UPLOAD_HIRES_RESTART',START:'UploadEvent/START',DONE:'UploadEvent/DONE',ERROR:'UploadEvent/ERROR',FINISHED_UPLOADING:'UploadEvent/FINISHED_UPLOADING',LOADED:'UploadEvent/LOADED',READY:'UploadEvent/READY',UPLOAD_FAILED:'UploadEvent/UPLOAD_FAILED',UPLOAD_PROGRESS:'UploadEvent/UPLOAD_PROGRESS',COMPRESS_PROGRESS:'UploadEvent/COMPRESS_PROGRESS',HI_RES_ATTACH_START:'UploadEvent/HI_RES_ATTACH_START',IMAGE_COMPRESS_ERROR:'UploadEvent/IMAGE_COMPRESS_ERROR',IMAGE_COMPRESS_BEGIN:'UploadEvent/IMAGE_COMPRESS_BEGIN',IMAGE_COMPRESSED:'UploadEvent/IMAGE_COMPRESSED',IMAGE_UPLOAD_ERROR:'UploadEvent/IMAGE_UPLOAD_ERROR',IMAGE_UPLOADED:'UploadEvent/IMAGE_UPLOADED',SELECT_START:'UploadEvent/SELECT_START',SELECT_CANCELED:'UploadEvent/SELECT_CANCELED',IMAGES_SELECTED:'UploadEvent/IMAGES_SELECTED',HEARTBEAT:'UploadEvent/HEARTBEAT',CANCELED_PROCESSING_PHOTO:'UploadEvent/CANCELED_PROCESSING_PHOTO',CANCELED_PHOTO_UPLOADED_ANYWAY:'UploadEvent/CANCELED_PHOTO_UPLOADED_ANYWAY'};e.exports=g;},null);
__d("FlashFilePicker",["Arbiter","ArbiterMixin","AsyncUploadBase","compareFlashVersions","ImageResizer","CSS","FilePickerEvent","Flash","FlashArbiterEvents","FlashLoadEvent","FlashUploaderConfig","HTML","Parent","PhotosUploadWaterfall","PhotosUploadWaterfallErrorCodes","PhotosUploadWaterfallMixin","PhotosUploadWaterfallXMixin","PUWApplications","UploadEvent","URI","PUWSteps","$"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();function ca(ga){for(var ha=0;ha<ga.length;++ha)if(n.checkMinVersion(ga[ha].toString()))return true;return false;}function da(ga){var ha=s.byClass(ga,'addPhotosDisabled');if(ha){l.removeClass(ha,'addPhotosDisabled');l.addClass(ha,'addPhotosEnabled');}}function ea(ga,ha){ha.style.width=ga.offsetWidth+'px';ha.style.height=ga.offsetHeight+'px';}function fa(ga,ha,ia){this._swfID=ga;this._button=ha;this._waterfallID=ia.qn;this._ref=ia.ref;this._beginInformed=false;this._isReady=false;this._fallbackHref=ia.fallbackHref;if(!ca(q.flashVersionInfo.minimumVersion)){this.logWaterfallStep(t.UPGRADE_REQUIRED);this._flashError(u.FLASH_UPGRADE_REQUIRED||25);return;}if(ia.flashObjectsPerVersion)this._constructAndAppendFlashObject(ia.flashObjectsPerVersion);this._flashEvents=new o(this._swfID).subscribe(p.READY,this._handleReady.bind(this)).subscribe(p.FAILED,this._handleFailed.bind(this)).subscribe(p.MOUSE_OVER,this._handleMouseIn.bind(this)).subscribe(p.MOUSE_OUT,this._handleMouseOut.bind(this)).subscribe(y.SELECT_START||'UploadEvent/SELECT_START',this._handleSelectStart.bind(this)).subscribe(y.IMAGES_SELECTED,this._handleSelected.bind(this)).subscribe(y.SELECT_CANCELED,this._handleCancelSelected.bind(this));this._timeout=setTimeout(function(){if(!this._isReady)this._flashError(u.FLASH_LOAD_TIMEOUT||23);}.bind(this),q.flashLoadTimeout);ia.logDetailed&&this.logDetailed();}Object.assign(fa.prototype,h,v,w,{_constructAndAppendFlashObject:function(ga){var ha=ga['default'];delete ga['default'];var ia=Object.keys(ga).sort(function(na,oa){return j(oa,na);}),ja=ha;for(var ka=0;ka<ia.length;ka++){var la=ia[ka];if(n.checkMinVersion(la)){ja=ga[la];break;}}var ma=r.replaceJSONWrapper(ja).getRootNode();this._button.parentNode.appendChild(ma);},getUploaderApp:function(){return t.APP_FLASH;},getWaterfallID:function(){return this._waterfallID;},getWaterfallAppName:function(){return x.WEB_FLASH;},getWaterfallSource:function(){return this._ref;},getSwfID:function(){return this._swfID;},logDetailed:function(){this.logWaterfallStep(t.VERSION,{version:n.getVersionString()});if(i.isSupported()){this.logWaterfallStep(t.ASYNC_AVAILABLE);if(k.isSupported()){this.logWaterfallStep(t.RESIZER_AVAILABLE);}else this.logStep(aa.CLIENT_PROCESS_UNAVAILABLE,{error:'no_resizer'});}else this.logStep(aa.CLIENT_PROCESS_UNAVAILABLE,{error:'no_async_upload'});},_handleReady:function(ga){setTimeout(function(){return ea(this._button,ba(this._swfID));}.bind(this));da(this._button);this._isReady=true;clearTimeout(this._timeout);g.inform(y.READY,{divID:this._swfID},g.BEHAVIOR_PERSISTENT);},_handleFailed:function(ga){this._flashError(u.FLASH_LOAD_FAILURE||24);},_flashError:function(ga){if(this._fallbackHref){var ha=new z(this._fallbackHref).addQueryData({error:ga}).toString();this._button.removeAttribute('rel');this._button.removeAttribute('ajaxify');this._button.setAttribute('href',ha);da(this._button);}this.logWaterfallStep(t.CLIENT_ERROR,{code:ga,scuba_tags:{fallback_simple:true}});this.logStep(aa.CLIENT_FLOW_FATAL,{error_code:ga,fallback_simple:true});},_handleMouseIn:function(ga){l.addClass(this._button,'selectOver');},_handleMouseOut:function(ga){l.removeClass(this._button,'selectOver');},_handleSelectStart:function(ga){if(!this._beginInformed){this._beginInformed=true;this.inform(m.BEGIN||'FilePickerEvent/BEGIN');}this.inform(m.SELECT_START);},_handleSelected:function(ga){var ha;if(ga.files){ha=ga.files;}else{ha=[{uploadID:ga.divID+'.'}];ha.length=ga.count;}this.inform(m.SELECTED,{sender:this,files:ha},g.BEHAVIOR_PERSISTENT);if(ga.albumLimitExceeded)this.inform(m.ALBUM_LIMIT_EXCEEDED,{},g.BEHAVIOR_PERSISTENT);if(ga.sessionLimitExceeded)this.inform(m.SESSION_LIMIT_EXCEEDED,{},g.BEHAVIOR_PERSISTENT);},_handleCancelSelected:function(ga){this.inform(m.SELECT_CANCELED);}});e.exports=fa;},null);
__d("HTML5FilePicker",["ArbiterMixin","BrowserSupport","CSS","DOM","FilePickerEvent","FileSelectionContainer","Parent","PhotosUploadID","PhotosUploadWaterfall","PhotosUploadWaterfallMixin","PhotosUploadWaterfallXMixin","PUWApplications","URI","PUWSteps","createArrayFromMixed","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();function w(x,y){this._config=Object.assign({accept:(void 0),multiple:(void 0)},y);this._button=x;this._beginInformed=false;if(!h.hasFileAPI()){this.logStep(t.CLIENT_PROCESS_UNAVAILABLE,{error:'no_file_api'});if(this._config.hasOwnProperty('fallbackFunction')){this._config.fallbackFunction.call(this);return;}var z=new s(this._button.getAttribute('ajaxify'));this._button.setAttribute('ajaxify',z.addQueryData({app:o.APP_FLASH}).toString());this.logWaterfallStep(o.FALLBACK_TO_FLASH);return;}this._subscriptions=[];var aa=this._config.input||j.create('input',{type:'file',className:"_n"});if(this._config.hasOwnProperty('accept'))aa.accept=this._config.accept;if(this._config.hasOwnProperty('multiple'))aa.multiple=this._config.multiple;if(this._config.hasOwnProperty('title'))aa.title=this._config.title;var ba=j.create('label',{className:'accessible_elem','for':j.getID(aa)},aa.title),ca=j.create('div',{className:"_3jk"},[ba,aa]);i.addClass(this._button,"_m");j.appendContent(this._button,ca);this._button.setAttribute('rel','ignore');this._bindInput(aa);var da=m.byClass(this._button,'addPhotosDisabled');if(da){i.removeClass(da,'addPhotosDisabled');i.addClass(da,'addPhotosEnabled');}}Object.assign(w.prototype,g,p,q,{getUploaderApp:function(){return o.APP_HTML5;},getWaterfallID:function(){return this._config.qn;},getWaterfallAppName:function(){return r.WEB_HTML5;},getWaterfallSource:function(){return this._config.ref;},getSwfID:function(){return null;},_constructFileList:function(){var x=u(this._input.files);x.forEach(function(y){y.uploadID=n.getNewID();});return x;},_constructFileSelectionContainerList:function(){var x=u(this._input.files);return x.map(function(y){return new l(y);});},cleanup:function(){if(this._input){this._input.onclick=null;this._input.onchange=null;}},_bindInput:function(x){this.cleanup();x.onclick=function(){this.logWaterfallStep(o.SELECT_START);if(!this._beginInformed){this._beginInformed=true;this.inform(k.BEGIN||'FilePickerEvent/BEGIN');}this.inform(k.SELECT_START);}.bind(this);x.onchange=function(){this.inform(k.SELECTED,{sender:this,files:this._constructFileList(),selections:this._constructFileSelectionContainerList()});this._bindInput(this._input.cloneNode(false));}.bind(this);if(this._input)j.replace(this._input,x);this._input=x;}});e.exports=w;},null);
__d("UploadSession",["AsyncRequest","FilePickerEvent","PhotosUploadWaterfall","PUWSteps","URI","arrayContains"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={};function n(p){"use strict";this._sessionID=p;this._asyncBootstrapped=false;this._controller=null;this._overlay=null;this._pickers=[];this._pendingFileLists=[];this._beginLogged=false;this._albumLimitWasExceeded=false;this._sessionLimitWasExceeded=false;}n.prototype.addFilePicker=function(p){"use strict";if(!l(this._pickers,p)){this._pickers.push(p);if(this._controller&&p.getSwfID&&p.getSwfID())this._controller.preregisterSwf&&this._controller.preregisterSwf(p.getSwfID());p.subscribe(h.BEGIN,function(q,r){if(!this._beginLogged){this._beginLogged=true;p.logWaterfallStep(i.BEGIN);p.logStep(j.CLIENT_FLOW_BEGIN);}}.bind(this));p.subscribe(h.SELECTED,function(q,r){p.logStep(j.CLIENT_SELECT_SUCCESS,{volume:r.files.length});if(this._controller){this._controller.uploadFiles(r.files);}else this._pendingFileLists.push(r);if(this._asyncBootstrapped)return;var s=p._button,t=new k(s.getAttribute('ajaxify'));t.addQueryData('num_selected',r.files.length);g.bootstrap(t.toString(),s,true);this._asyncBootstrapped=true;}.bind(this));p.subscribe(h.SELECT_START,function(){p.logStep(j.CLIENT_SELECT_BEGIN);}.bind(this));p.subscribe(h.SELECT_CANCELED,function(){p.logStep(j.CLIENT_SELECT_CANCEL);if(!this._overlay){p.logStep(j.CLIENT_FLOW_CANCEL);this._beginLogged=false;}}.bind(this));p.subscribe(h.ALBUM_LIMIT_EXCEEDED,function(){if(this._controller){this._controller.albumLimitExceeded();}else this._albumLimitWasExceeded=true;}.bind(this));p.subscribe(h.SESSION_LIMIT_EXCEEDED,function(){if(this._controller){this._controller.sessionLimitExceeded();}else this._sessionLimitWasExceeded=true;}.bind(this));}};n.prototype.addController=function(p){"use strict";this._controller=p;this._asyncBootstrapped=true;var q=(this._controller.getWaterfallID)?this._controller.getWaterfallID():this._controller.getWaterfallConfig().waterfallID,r=(this._controller.getUploaderApp)?this._controller.getUploaderApp():this._controller.getWaterfallConfig().waterfallApp;if(!this._beginLogged){this._beginLogged=true;i.sendSignal({qn:q,step:i.BEGIN,uploader:r});}if(this._pendingFileLists.length){var s=[];this._pendingFileLists.forEach(function(t){s=s.concat(t.files);});this._controller.uploadFiles(s);}else i.sendSignal({qn:q,step:i.OVERLAY_FIRST,uploader:r});if(this._albumLimitWasExceeded)this._controller.albumLimitExceeded();if(this._sessionLimitWasExceeded)this._controller.sessionLimitExceeded();};n.prototype.addOverlay=function(p){"use strict";this._overlay=p;};n.prototype.addOverlayAndController=function(p,q){"use strict";this.addOverlay(p);this.addController(q);};n.addFilePickerToSession=function(p,q){"use strict";o(p).addFilePicker(q);};n.addControllerToSession=function(p,q){"use strict";o(p).addController(q);};n.addOverlayToSession=function(p,q){"use strict";o(p).addOverlay(q);};n.addOverlayAndControllerToSession=function(p,q,r){"use strict";o(p).addOverlayAndController(q,r);};function o(p){if(!m[p])m[p]=new n(p);return m[p];}e.exports=n;},null);
__d("StoryTopicMap",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={},h={registerTopics:function(i,j){g[i]=j;},getTopicsForFTID:function(i){return g[i]||[];}};e.exports=h;},null);
__d("XEventRelatedEventsPivotController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/events\/async\/related_events_pivot\/",{event_id:{type:"Int",required:true},attachment_id:{type:"String",required:true}});},null);
__d("XSearchRelatedPostsPivotController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/search\/async\/related_posts_pivot\/",{origin:{type:"String",required:true},content_id:{type:"String",required:true}});},null);
__d("XPubcontentFeedChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pubcontent\/feed_chaining\/",{actor_id:{type:"String",required:true},content_id:{type:"String"},ft_id:{type:"String"},origin:{type:"String",required:true}});},null);
__d("XPubcontentRelatedShareChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pubcontent\/related_share\/",{attachment_div_id:{type:"String",required:true},global_share_id:{type:"Int",required:true},video_div_id:{type:"String"},link_url:{type:"String"},qid:{type:"String"},mf_story_key:{type:"String"},share_id:{type:"String"},is_auto_expand:{type:"Bool",defaultValue:false}});},null);
__d("XPubcontentRelatedVideoChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pubcontent\/related_video\/",{attachment_div_id:{type:"String",required:true},fbvideo_id:{type:"Int",required:true},qid:{type:"String"},mf_story_key:{type:"String"}});},null);
__d("XPubcontentTopicChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pubcontent\/topic_chaining\/",{pivotal_topic_ids:{type:"IntVector",defaultValue:[]}});},null);
__d("XPubcontentInlineStoryPivotChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pubcontent\/inline_story_pivot_chaining\/",{origin:{type:"String",required:true},storyid:{type:"String"},ftid:{type:"String"}});},null);
__d("XRelatedGamesChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/games\/async\/related_games\/",{attachment_div_id:{type:"String",required:true},app_id:{type:"Int",required:true}});},null);
__d("XTopicConversationFeedPivotChainingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/discussions\/creation_unit\/",{});},null);
__d("PubcontentFeedChainingController",["AggregatedLinkComposerConfig","Arbiter","AsyncRequest","AttachmentRelatedShareConstants","CreateTopicConversationChainingConfig","CSS","cx","DOM","DOMQuery","FeedAdsChainingConfig","NavigationMessage","PageLikeConstants","PubcontentFeedChainingConfig","PubcontentRelatedShareChainingConfig","PubcontentTopicChainingConfig","StoryInlinePivotChainingConfig","RelatedEventsPivotChainingConfig","Run","SearchRelatedPostsPivotChainingConfig","StoryTopicMap","SubscriptionsHandler","UFIFeedbackTargets","UFIUIEvents","XEventRelatedEventsPivotController","XSearchRelatedPostsPivotController","XFeedAdsChainingController","XPubcontentFeedChainingController","XPubcontentRelatedShareChainingController","XPubcontentRelatedVideoChainingController","XPubcontentTopicChainingController","XPubcontentInlineStoryPivotChainingController","XRelatedGamesChainingController","XTopicConversationFeedPivotChainingController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){b.__markCompiled&&b.__markCompiled();var na='ei',oa='ad_fan_page_action',pa='ad_like_page_post_action',qa='page_story_like_action',ra='related_share_article_click',sa='related_share_video_click',ta='page_share_like_action',ua='topic_story_like_action',va='story_click_for_pivot_action',wa='story_like_pivot_action',xa='event_join',ya='comment_on_topic_conversation_target_action',za='composer_publish_action';function ab(){"use strict";this.$PubcontentFeedChainingController0=s;this.$PubcontentFeedChainingController1=p;this.$PubcontentFeedChainingController2=t;this.$PubcontentFeedChainingController3=u;this.$PubcontentFeedChainingController4=v;this.$PubcontentFeedChainingController5=w;this.$PubcontentFeedChainingController6=y;this.$PubcontentFeedChainingController7=k;this.$PubcontentFeedChainingController8={};this.registerEvents();ab.instance=this;}ab.prototype.registerEvents=function(){"use strict";if(this.$PubcontentFeedChainingController9)return;this.$PubcontentFeedChainingController9=new aa();this.$PubcontentFeedChainingController9.addSubscriptions(h.subscribe(q.NAVIGATION_BEGIN,this.$PubcontentFeedChainingControllera.bind(this)),h.subscribe(r.LIKED,this.$PubcontentFeedChainingControllerb.bind(this)),h.subscribe(ca.UFIActionLinkLike,this.$PubcontentFeedChainingControllerc.bind(this)),h.subscribe(ca.UFIActionAddComment,this.$PubcontentFeedChainingControllerd.bind(this)),h.subscribe('composer/publish',this.$PubcontentFeedChainingControllere.bind(this)),h.subscribe('LitestandComposer/publish',this.$PubcontentFeedChainingControllere.bind(this)),h.subscribe(j.ARTICLE_CLICK,this.$PubcontentFeedChainingControllerf.bind(this)),h.subscribe(j.VIDEO_CLICK,this.$PubcontentFeedChainingControllerg.bind(this)),h.subscribe(j.FBVIDEO_CLICK,this.$PubcontentFeedChainingControllerh.bind(this)),h.subscribe(j.GAME_CLICK,this.$PubcontentFeedChainingControlleri.bind(this)),h.subscribe(j.PHOTO_CLICK,this.$PubcontentFeedChainingControllerj.bind(this)),h.subscribe(j.EVENT_JOIN,this.$PubcontentFeedChainingControllerk.bind(this)));x.onLeave(this.$PubcontentFeedChainingControllera.bind(this));};ab.prototype.$PubcontentFeedChainingControllera=function(){"use strict";this.$PubcontentFeedChainingController9&&this.$PubcontentFeedChainingController9.release();this.$PubcontentFeedChainingController9=null;};ab.getAdClientTokenIndex=function(){"use strict";return na;};ab.prototype.$PubcontentFeedChainingControllerb=function(bb,cb){"use strict";var db=this.findAdClientToken(cb.target);if(db){this.$PubcontentFeedChainingControllerl(cb.target,{origin:oa,actor_id:cb.profile_id,client_token:db});}else this.$PubcontentFeedChainingControllerm(cb.target,{origin:cb.origin,actor_id:cb.profile_id});};ab.prototype.$PubcontentFeedChainingControllerd=function(bb,cb){"use strict";if(!cb.feedback)return;var db=this.$PubcontentFeedChainingControllern(cb.target,{origin:ya,data:cb});if(!db)return false;var eb=ma.getURIBuilder().getURI();new i(eb).setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setMethod('POST').setData({story_id:cb.feedback.entidentifier}).send();return true;};ab.prototype.$PubcontentFeedChainingControllerc=function(bb,cb){"use strict";if(!cb.ft_id)return;if(!this.$PubcontentFeedChainingControllerp(this.findStory(cb.target)))return;ba.getFeedbackTarget(cb.ft_id,function(db,eb){var fb=this.findAdClientToken(db);if(fb&&eb.isshare){this.$PubcontentFeedChainingControllerl(db,{actor_id:eb.actorid,origin:pa,ft_id:eb.entidentifier,client_token:fb});}else if(eb.isownerpage){this.$PubcontentFeedChainingControllerm(db,{actor_id:eb.actorid,content_id:eb.entidentifier,origin:qa});}else if(eb.isshare){this.$PubcontentFeedChainingControllerm(db,{actor_id:eb.actorid,content_id:eb.entidentifier,ft_id:eb.entidentifier,origin:ta});}else{var gb=z.getTopicsForFTID(eb.entidentifier);if(gb&&gb.length>0){this.$PubcontentFeedChainingControllerq(db,{ft_id:eb.entidentifier,origin:ua,pivotal_topic_ids:gb});}else this.$PubcontentFeedChainingControllerr(db,{origin:wa,ft_id:eb.entidentifier});}}.bind(this,cb.target));};ab.prototype.$PubcontentFeedChainingControllerr=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=(ka.getURIBuilder()).setString('origin',cb.origin);if(cb.story_id)eb.setString('storyid',String(cb.story_id));if(cb.ft_id)eb.setString('ftid',String(cb.ft_id));new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb.getURI()).setAllowCrossPageTransition(true).send();return true;};ab.prototype.$PubcontentFeedChainingControllerj=function(bb,cb){"use strict";var db=this;db.$PubcontentFeedChainingControllerr(cb.attachment,{origin:va,story_id:cb.storyid});};ab.prototype.$PubcontentFeedChainingControllerf=function(bb,cb){"use strict";if(g.no_chained_related_stories==='true')return;cb.origin=ra;var db=this,eb=this.findStory(cb.attachment),fb=o.scry(o.getRootElement(),'#initial_browse_result').length>0;if(fb)return;var gb;if(cb.is_right_click){gb=0;}else gb=j.EVENT_DELAY;setTimeout(function(){if(eb){var hb=db.findAttachment(eb);if(hb)cb.attachment=hb;}db.$PubcontentFeedChainingControllers(cb.attachment,cb);},gb);};ab.prototype.$PubcontentFeedChainingControllerg=function(bb,cb){"use strict";cb.origin=sa;var db=this,eb=this.findStory(cb.attachment);setTimeout(function(){if(eb){var fb=db.findAttachment(eb);if(fb)cb.attachment=fb;}db.$PubcontentFeedChainingControllers(cb.attachment,cb);},j.EVENT_DELAY);};ab.prototype.$PubcontentFeedChainingControllerh=function(bb,cb){"use strict";cb.origin=sa;var db=this,eb=this.findStory(cb.attachment);setTimeout(function(){if(eb){var fb=db.findAttachment(eb);if(fb)cb.attachment=fb;}db.$PubcontentFeedChainingControllers(cb.attachment,cb);},j.EVENT_DELAY);};ab.prototype.$PubcontentFeedChainingControlleri=function(bb,cb){"use strict";var db=this,eb=this.findStory(cb.attachment);setTimeout(function(){if(eb)var fb=db.findContainer(eb);db.$PubcontentFeedChainingControllert(eb,cb.global_share_id,n.getID(fb));},j.EVENT_DELAY);};ab.prototype.$PubcontentFeedChainingControllerk=function(bb,cb){"use strict";var db=this.findStory(cb.attachment);if(db){var eb=this.findAttachment(db);if(eb)cb.attachment=eb;}this.$PubcontentFeedChainingControlleru(cb.attachment,{origin:xa,event_id:cb.event_id});};ab.prototype.$PubcontentFeedChainingControllere=function(bb,cb){"use strict";var db=this;setTimeout(function(){db.$PubcontentFeedChainingControllerv(cb.markup.firstChild,{origin:za,content_id:cb.content_id});},this.$PubcontentFeedChainingController6.composer_publish_action);};ab.prototype.$PubcontentFeedChainingControllerw=function(bb){"use strict";return !!(bb&&bb.id&&!l.hasClass(bb,"_sf6")&&!(bb.id in this.$PubcontentFeedChainingController8));};ab.prototype.$PubcontentFeedChainingControllerx=function(bb){"use strict";if(!bb)return false;if(bb.origin in this.$PubcontentFeedChainingController0||bb.origin in this.$PubcontentFeedChainingController2||bb.origin in this.$PubcontentFeedChainingController1||bb.origin in this.$PubcontentFeedChainingController4||bb.origin in this.$PubcontentFeedChainingController5||bb.origin in this.$PubcontentFeedChainingController7||bb.origin in this.$PubcontentFeedChainingController6){return true;}else{var cb=this.$PubcontentFeedChainingController3[bb.origin];if(!cb||!cb.rate)return false;var db=Math.random();if(db>cb.rate)return false;return true;}};ab.prototype.$PubcontentFeedChainingControllery=function(bb){"use strict";this.$PubcontentFeedChainingController8[bb]=true;};ab.prototype.$PubcontentFeedChainingControllero=function(bb){"use strict";delete this.$PubcontentFeedChainingController8[bb];};ab.prototype.$PubcontentFeedChainingControllerp=function(bb){"use strict";if(!bb)return false;var cb="_3lkn",db=bb.nextSibling,eb=true;if(db&&db.firstChild){var fb=db.firstChild;eb=!(fb.hasChildNodes()&&l.hasClass(fb,cb));}if(!eb)return false;var gb=bb.children[0],hb=bb.children[1],ib="_4_ck";if((gb&&l.hasClass(gb,ib))||(hb&&l.hasClass(hb,ib)))return false;return true;};ab.prototype.$PubcontentFeedChainingControllern=function(bb,cb){"use strict";var db=this.findStory(bb);if(!this.$PubcontentFeedChainingControllerw(db))return null;if(!this.$PubcontentFeedChainingControllerx(cb))return null;this.$PubcontentFeedChainingControllery(db.id);if(this.isSponsoredStory(db))return null;var eb;if(!cb.continued_chaining){eb=this.findContainer(db);if(!eb)return null;var fb=n.create('div'),gb=n.appendContent(eb,fb);if(gb.length!==1)return null;}else{eb=db;fb=n.create('div');gb=n.insertAfter(eb,fb);n.remove(eb);if(gb.length!==1)return null;}if(cb.is_auto_expand){return {chainingWrapper:gb[0],story:db,is_auto_expand:cb.is_auto_expand};}else return {chainingWrapper:gb[0],story:db};};ab.prototype.$PubcontentFeedChainingControllerl=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=this.findStreamRoot(db.story);if(!eb)return false;var fb=eb.getAttribute('id'),gb=(fa.getURIBuilder()).setString('actor_id',cb.actor_id).setString('origin',cb.origin).setString('ei',cb.client_token).setString('data_ownerid',fb);if(cb.ft_id)gb.setString('ft_id',cb.ft_id);new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(gb.getURI()).send();return true;};ab.prototype.$PubcontentFeedChainingControllers=function(bb,cb){"use strict";if(!this.$PubcontentFeedChainingControllerp(this.findStory(bb)))return false;var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;l.addClass(db.chainingWrapper,"_3lkn");var eb=null;if(cb.fbvideo_id){eb=ia.getURIBuilder();eb.setInt('fbvideo_id',cb.fbvideo_id);}else{eb=ha.getURIBuilder();eb.setInt('global_share_id',cb.global_share_id);}eb.setString('attachment_div_id',n.getID(cb.attachment));if(cb.link_url)eb.setString('link_url',cb.link_url);if(cb.video_div_id)eb.setString('video_div_id',cb.video_div_id);if(cb.share_id)eb.setString('share_id',cb.share_id);var fb=JSON.parse(db.story.getAttribute('data-ft'))||{};if('qid' in fb&&'mf_story_key' in fb){eb.setString('qid',fb.qid);eb.setString('mf_story_key',fb.mf_story_key);}if(cb.is_auto_expand){this.$PubcontentFeedChainingControllero(db.story.id);eb.setBool('is_auto_expand',cb.is_auto_expand);}var gb=new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb.getURI());fb&&gb.setData(fb);gb.send();return true;};ab.prototype.$PubcontentFeedChainingControllert=function(bb,cb,db){"use strict";if(!this.$PubcontentFeedChainingControllerw(bb))return;this.$PubcontentFeedChainingControllery(bb.id);var eb=(la.getURIBuilder()).setInt('app_id',cb).setString('attachment_div_id',db);new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,bb.id)).setURI(eb.getURI()).send();return true;};ab.prototype.$PubcontentFeedChainingControllerm=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=(ga.getURIBuilder()).setString('actor_id',cb.actor_id).setString('origin',cb.origin);if(cb.ft_id)eb.setString('ft_id',cb.ft_id);if(cb.content_id)eb.setString('content_id',cb.content_id);new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb.getURI()).send();return true;};ab.prototype.$PubcontentFeedChainingControllerq=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=(ja.getURIBuilder()).setIntVector('pivotal_topic_ids',cb.pivotal_topic_ids).getURI();new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb).send();return true;};ab.prototype.$PubcontentFeedChainingControlleru=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=(da.getURIBuilder()).setInt('event_id',cb.event_id).setString('attachment_id',n.getID(bb)).getURI();new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb).send();return true;};ab.prototype.$PubcontentFeedChainingControllerv=function(bb,cb){"use strict";var db=this.$PubcontentFeedChainingControllern(bb,cb);if(!db)return false;var eb=(ea.getURIBuilder()).setString('origin',cb.origin).setString('content_id',String(cb.content_id));new i().setErrorHandler(this.$PubcontentFeedChainingControllero.bind(this,db.story.id)).setRelativeTo(db.chainingWrapper).setURI(eb.getURI()).setAllowCrossPageTransition(true).send();return true;};e.exports=ab;},null);
__d("PubcontentLitestandClassicChainingController",["ContextualThing","DOM","PubcontentFeedChainingController","csx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();for(var k in i)if(i.hasOwnProperty(k))m[k]=i[k];var l=i===null?null:i.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=i;function m(){"use strict";if(i!==null)i.apply(this,arguments);}m.prototype.findStory=function(n){"use strict";var o="^div._4-u2",p=h.scry(n,o);return p.length===1?p[0]:null;};m.prototype.isSponsoredStory=function(n){"use strict";var o="._5paw";return h.scry(n,o).length>0;};m.prototype.findAttachment=function(n){"use strict";var o="div._6m2",p="div.iframeEmbed",q=h.scry(n,o)[0]||h.scry(n,p)[0];return q;};m.prototype.findContainer=function(n){"use strict";var o=h.create('div'),p=h.insertAfter(n,o);g.register(o,n);return p.length>=1?p[0]:null;};m.prototype.findStreamRoot=function(n){"use strict";var o="^div._4ikz";return h.scry(n,o)[0];};m.prototype.findAdClientToken=function(n){"use strict";var o=this.findStory(n);if(!o)return null;var p=o.getAttribute('data-ft');if(!p)return null;var q=JSON.parse(p);return q[i.getAdClientTokenIndex()];};m.prototype.init=function(){"use strict";this.registerEvents();};e.exports=new m();},null);
__d("XSearchAwarenessController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/search\/async\/awareness\/",{origin:{type:"String",required:true},story_id:{type:"String"},actor_id:{type:"String"},global_share_id:{type:"String"},query:{type:"String"}});},null);
__d("SearchAwarenessDispatcher",["Arbiter","AsyncRequest","AttachmentRelatedShareConstants","NavigationMessage","PageLikeConstants","Run","SubscriptionsHandler","UFIFeedbackTargets","UFIUIEvents","SearchAwarenessWebConfig","XSearchAwarenessController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r='ARTICLE_CLICK_ACTION',s='STORY_CLICK_ACTION',t='STORY_LIKE_ACTION',u='COMPOSER_PUBLISH_ACTION',v='FAN_PAGE_ACTION',w='SERP_LOAD';function x(){"use strict";this.$SearchAwarenessDispatcher0=p;this.$SearchAwarenessDispatcher1={};this.registerEvents();x.instance=this;}x.prototype.init=function(){"use strict";this.registerEvents();};x.prototype.registerEvents=function(){"use strict";if(!this.$SearchAwarenessDispatcher0.master_gk)return;if(this.$SearchAwarenessDispatcher2)return;this.$SearchAwarenessDispatcher2=new m();this.$SearchAwarenessDispatcher2.addSubscriptions(g.subscribe(j.NAVIGATION_BEGIN,this.$SearchAwarenessDispatcher3.bind(this)),g.subscribe(k.LIKED,this.$SearchAwarenessDispatcher4.bind(this)),g.subscribe(o.UFIActionLinkLike,this.$SearchAwarenessDispatcher5.bind(this)),g.subscribe('composer/publish',this.$SearchAwarenessDispatcher6.bind(this)),g.subscribe('LitestandComposer/publish',this.$SearchAwarenessDispatcher6.bind(this)),g.subscribe(i.ARTICLE_CLICK,this.$SearchAwarenessDispatcher7.bind(this)));l.onLeave(this.$SearchAwarenessDispatcher3.bind(this));};x.prototype.$SearchAwarenessDispatcher3=function(){"use strict";this.$SearchAwarenessDispatcher2&&this.$SearchAwarenessDispatcher2.release();this.$SearchAwarenessDispatcher2=null;};x.prototype.$SearchAwarenessDispatcher4=function(y,z){"use strict";this.$SearchAwarenessDispatcher8(z.target,{origin:v,actor_id:z.profile_id});};x.prototype.$SearchAwarenessDispatcher5=function(y,z){"use strict";if(!z.ft_id)return;n.getFeedbackTarget(z.ft_id,function(aa,ba){this.$SearchAwarenessDispatcher8(z.target,{actor_id:ba.actorid,story_id:ba.entidentifier,origin:t});}.bind(this,z.target));};x.prototype.$SearchAwarenessDispatcher9=function(y,z){"use strict";this.$SearchAwarenessDispatcher8(z.target,{story_id:z.storyid,origin:s});};x.prototype.$SearchAwarenessDispatcher7=function(y,z){"use strict";this.$SearchAwarenessDispatcher8(z.target,{global_share_id:z.global_share_id,story_id:z.share_id,origin:r});};x.prototype.$SearchAwarenessDispatcher6=function(y,z){"use strict";this.$SearchAwarenessDispatcher8(z.markup.firstChild,{story_id:z.content_id,origin:u});};x.prototype.onSERPLoad=function(y){"use strict";if(!y||!this.$SearchAwarenessDispatcher0.master_gk)return;this.$SearchAwarenessDispatcher8(null,{query:y,origin:w});};x.prototype.$SearchAwarenessDispatcher8=function(y,z){"use strict";if(!z.origin)return true;var aa=(q.getURIBuilder()).setString('origin',z.origin);if(z.story_id)aa.setString('story_id',z.story_id);if(z.actor_id)aa.setString('actor_id',z.actor_id);if(z.global_share_id)aa.setString('global_share_id',z.global_share_id);if(z.query)aa.setString('query',z.query);new h().setRelativeTo(y).setURI(aa.getURI()).send();return true;};x.prototype.showAwarenessExperienceNow=function(y){"use strict";y&&y.show();};e.exports=new x();},null);
__d("FeedAdsGapRuleViolationDetection",["Banzai","CSS","csx","cx","DOM","ge","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n='ei',o='qid',p='gap rule violation',q='non violating ads gap',r='first position violation',s='feed load',t='first position invalidation',u='spacing invalidation',v=[],w=[],x=[],y={},z={},aa={registerFeedStories:function(ba,ca){if(ba.containerID=='substream_0'){v=[];w=[];}var da=l(ba.containerID);if(!da)return;y=Object.assign({},ba.demoAdChecks,y);var ea=k.scry(da,"div._5jmm").map(this._convertStoryNodeToObject).filter(function(ga){return ga!==null;});if(ba.isLoggingEnabled&&ea.length!==0)this._logFeedLoad();if(ba.isNewerStories){v=ea.concat(v);}else v=v.concat(ea);for(var fa in ba.minGaps)if(ba.minGaps.hasOwnProperty(fa))z[fa]=ba.minGaps[fa];if(m(y)){if(ba.isLoggingEnabled||ba.isFirstPosInvalidationEnabled)this._checkFirstPosViolation(ba,da);if(ba.isLoggingEnabled||ba.isGapRuleInvalidationEnabled)this._checkGapRuleViolation(ba);}},_convertStoryNodeToObject:function(ba){if(h.hasClass(ba,"_170y"))return null;var ca=ba.getAttribute('data-dedupekey');if(y[ca])return null;var da=k.scry(ba,"div._hye"),ea=k.scry(ba,"li._170x"),fa=[];if(da.length!==0){fa=da.map(function(ia){return ia.getAttribute('data-ft');}).filter(function(ia){return ia!==null;});}else if(ea.length!==0){fa=ea.map(function(ia){return ia.getAttribute('data-ft');}).filter(function(ia){return ia!==null;});}else if(ba.getAttribute('data-ft'))fa=[ba.getAttribute('data-ft')];if(!fa.length)return null;var ga=JSON.parse(fa[0]),ha={dataFTArray:fa,dedupKey:ca,isSponsored:!!ga[n],height:ba.offsetHeight,qid:parseInt(ga[o],10),nodeID:ba.id};return ha;},_checkFirstPosViolation:function(ba,ca){while(v.length>0&&v[0].isSponsored){var da={ftArray:v[0].dataFTArray,qid:v[0].qid,nodeid:v[0].nodeID,firstStoryType:ba.firstStoryType},ea=k.scry(ca,'.uiBoxRed')[0];if(ea){var fa=ea.textContent||ea.innerText;if(fa)da.error_msg=fa;}if(ba.isLoggingEnabled&&!(v[0].dedupKey in x)){this._logFirstPosViolation(da);x[v[0].dedupKey]=da;}if(ba.isFirstPosInvalidationEnabled){this._invalidateFirstPosAd(da);v.splice(0,1);}else break;}},_getMinGap:function(ba,ca,da){var ea=Math.min(ba?ba:Number.MAX_VALUE,ca?ca:Number.MAX_VALUE);return ea!==Number.MAX_VALUE?ea:da;},_getStoryDedupKeysJSONString:function(ba,ca){var da=[];for(var ea=ba;ea<=ca;ea++)da.push(v[ea].dedupKey);return JSON.stringify(da);},_getIdxOfStoryToSwap:function(ba,ca){if(ca>=(v.length-ba))return -1;for(var da=ba+1;(da<v.length)&&(ca>0);da++){if(!v[da].isSponsored){ca--;}else return -1;if(ca===0)return da;}return -1;},_checkGapRuleViolation:function(ba){var ca=null,da=null,ea=0;for(var fa=0;fa<v.length;fa++){var ga=v[fa];ea+=ga.height;if(ga.isSponsored){ea-=ga.height;var ha=false,ia=false;if(ca!==null){var ja=fa-ca,ka=null,la=this._getMinGap(z[da.dedupKey],z[ga.dedupKey],ba.defaultMinGap);if(ja<la){ka=p;}else ka=q;var ma={ftArray_A:da.dataFTArray,ftArray_B:ga.dataFTArray,dist:ja,pdist:ea,pos:fa+1,qid_A:da.qid,qid_B:ga.qid,event_type:ka,nodeid:ga.nodeID,dedupKeys:this._getStoryDedupKeysJSONString(ca,fa)};if(ba.isLoggingEnabled)if(!(ga.dedupKey in w)||w[ga.dedupKey].event_type!==ka){this._logAdsGapEvent(ma);w[ga.dedupKey]=ma;}if(ba.isGapRuleInvalidationEnabled&&ka==p){var na=-1;if(ba.isSwapOnGapRuleViolationEnabled)na=this._getIdxOfStoryToSwap(fa,la-ja);if(na>0){this._shiftAdBelowOrganicStory(ga.nodeID,v[na].nodeID);var oa=v[fa];v.splice(fa,1);v.splice(na,0,oa);if(ba.isLoggingEnabled){var pa={ft:v[na].dataFTArray[0],dist:(na-fa),qid:v[na].qid,event_type:'ad_swap'};g.post('feed_ads_gap_rule_violation',pa);}ia=true;ga=v[fa];ea+=ga.height;}else if(ba.isGapRuleInvalidationEnabled){this._invalidateGapRuleViolatedAd(ma);ha=true;v.splice(fa--,1);}}}if(!ha&&!ia){ca=fa;da=ga;ea=0;}}}},_logFirstPosViolation:function(ba){var ca={ft:ba.ftArray[0],event_type:r,intValues:{qid:ba.qid},first_story_type:ba.firstStoryType};if(ba.error_msg)ca.error_msg=ba.error_msg;g.post('feed_ads_gap_rule_violation',ca);},_logAdsGapEvent:function(ba){var ca={ft_A:ba.ftArray_A[0],ft_B:ba.ftArray_B[0],event_type:ba.event_type,intValues:{dist:ba.dist,pdist:ba.pdist,pos:ba.pos,qid_A:ba.qid_A,qid_B:ba.qid_B},dedup_keys:ba.dedupKeys};g.post('feed_ads_gap_rule_violation',ca);},_logFeedLoad:function(){var ba={event_type:s};g.post('feed_ads_gap_rule_violation',ba);},_invalidateFirstPosAd:function(ba){h.hide(l(ba.nodeid));var ca={ft_array:ba.ftArray,event_type:t};g.post('feed_ads_gap_rule_violation',ca);},_invalidateGapRuleViolatedAd:function(ba){var ca=l(ba.nodeid);ca&&h.hide(ca);var da={ft_array_A:ba.ftArray_A,ft_array_B:ba.ftArray_B,event_type:u};g.post('feed_ads_gap_rule_violation',da);},_shiftAdBelowOrganicStory:function(ba,ca){var da=l(ba),ea=l(ca);da&&ea&&k.insertAfter(ea,da);}};e.exports=aa;},null);
__d("StoryPositionTracking",["DOM","LitestandStream","csx","ge"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=0;function l(o,p){var q=JSON.parse(o.getAttribute('data-ft'));if(q){q.insertion_position=p;o.setAttribute('data-ft',JSON.stringify(q));}}function m(o){return g.scry(o,"._5jmm");}var n={registerNewStories:function(o){if(o=='substream_0')k=0;var p=m(j(o)),q=p.length;for(var r=0;r<q;r++)l(p[r],k++);},updateAllStories:function(){var o=m(h.getStreamRoot()),p=o.length;k=0;for(var q=0;q<p;q++)l(o[q],k++);}};e.exports=n;},null);
__d("StreamViewportTracking",["DOM","DOMDimensions","ViewportTracking","ge","recordTNTreeData"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=51;for(var m in i)if(i.hasOwnProperty(m))o[m]=i[m];var n=i===null?null:i.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=i;function o(){"use strict";if(i!==null)i.apply(this,arguments);}o.prototype.init=function(p,q){"use strict";if(q)this.$StreamViewportTracking0=q;n.init.call(this,p);this.initSubscriptions();};o.prototype.initSubscriptions=function(){"use strict";};o.prototype.getDataFromConfig=function(p){"use strict";this.isTimetrackingEnabled=1;this.timeout=p.record_delay;};o.prototype.getTimeout=function(){"use strict";return this.timeout;};o.prototype.getStorySelector=function(){"use strict";return '.uiStreamStory';};o.prototype.getAllStories=function(){"use strict";var p=g.scry(this.getStream(),this.getStorySelector());return p.filter(function(q){return q.getAttribute('data-ft');});};o.prototype.getStoryID=function(p){"use strict";var q=JSON.parse(p.getAttribute('data-ft'));return q.mf_story_key;};o.prototype.getQueryID=function(p){"use strict";var q=JSON.parse(p.getAttribute('data-ft'));return q.qid;};o.prototype.getFBFeedLocations=function(p){"use strict";var q=JSON.parse(p.getAttribute('data-ft'));return q.fbfeed_location;};o.prototype.getFBFeedInsertionPosition=function(p){"use strict";var q=JSON.parse(p.getAttribute('data-ft'));return q.insertion_position;};o.prototype.getDataToLog=function(p){"use strict";var q={},r=this.getStream();q=k(p,r);var s=p.getAttribute('data-insertion-position');if(s!==null)q.inspos=s;q.evt=l;q.vpv_time=Math.round(Date.now()/1000);var t=g.scry(p,".fbStoryAttachmentImage")[0];if(t){var u=h.getElementDimensions(t);q.story_image_height=u.height;q.story_image_width=u.width;}return {ft:q};};o.prototype.getStream=function(){"use strict";if(this.$StreamViewportTracking0)return this.$StreamViewportTracking0;return j('home_stream');};o.prototype.heartBeatIsEnabled=function(){"use strict";return true;};o.init=function(p,q){"use strict";o.instance=new o();o.instance.init(p,q);};o.getInstance=function(){"use strict";return o.instance;};e.exports=o;},null);
__d("FbFeedAttachmentRelatedShare",["Arbiter","AttachmentRelatedShareConstants","DOMQuery","Event","tidyEvent","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={loadRelatedAttachment:function(n,o){k(j.listen(n,'click',function(){g.inform(h.ARTICLE_CLICK,{attachment:n,global_share_id:o});}));},loadRelatedGameAttachment:function(n,o){k(j.listen(n,'click',function(){g.inform(h.GAME_CLICK,{attachment:n,global_share_id:o});}));},loadRelatedAttachmentForStream:function(n){var o=function(event,p){var q=event.getTarget();if(q.getAttribute('target')!=='_blank')return;var r="^div._5pbx",s="^div._5pc9",t=i.scry(q,r)[0]||i.scry(q,s)[0];if(!t)return;g.inform(h.ARTICLE_CLICK,{attachment:t,global_share_id:0,link_url:q.getAttribute('href'),is_right_click:p});};k(j.listen(n,'click',function(event){o(event,false);}));k(j.listen(n,'mousedown',function(event){if(event.which==3||event.button==2)o(event,true);}));}};e.exports=m;},null);
__d("FbFeedViewportTracking",["Arbiter","LitestandMessages","LitestandStream","StreamViewportTracking","csx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();for(var l in j)if(j.hasOwnProperty(l))n[l]=j[l];var m=j===null?null:j.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=j;function n(){"use strict";if(j!==null)j.apply(this,arguments);}n.prototype.initSubscriptions=function(){"use strict";this.subscriptions.addSubscriptions(g.subscribe([h.STORIES_INSERTED],this.invalidateAllStoriesCache.bind(this)),g.subscribe(h.LEAVE_HOME,this.updateTimeTrackingData.bind(this,true)));};n.prototype.getStorySelector=function(){"use strict";return "._5jmm";};n.prototype.getStream=function(){"use strict";return i.getStreamRoot();};n.prototype.getSessionID=function(){"use strict";return i.getFeedStreamID();};n.init=function(o){"use strict";n.instance=new n();n.instance.init(o);};n.getInstance=function(){"use strict";return n.instance;};e.exports=n;},null);